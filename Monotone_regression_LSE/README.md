# monotone-regression

This directory contains four methods for constructing credible/confidence intervals for monotone regression. In all cases, data are generated for the example in the paper of Moumita Chakraborti and Subhashis Ghosal "Coverage of Credible Intervals in Nonparametric Monotone Regression" in the Annals of Statistics (2021), vol. 49, pp. 1011-1028. The code is run by running the .R file, which produces pictures of the 95% intervals for the last of the 1000 original samples, and a picture of the proportion of time that values of the function f_0(x)=x^2+x/5 on [0,1] were inside the intervals for the 1000 original samples. Numbers of iterations over the original samples are printed to indicate the progress of the program through the draws of the 1000 samples.

In the directory "credible_intervals (Rcpp)" the intervals are computed using the method of the paper of Moumita and Subhashis (we thank Moumita for sending the R code of her program, see the directory "Credible Interval codes (Chakraborti_Ghosal)"). In this case 1000 samples (X_1,Y_1),...(X_n,Y_n) of size n (to be determined by the user) are generated, where X_i is generated from a Uniform(0,1) distribution and Y_i is the sum of f_0(X_i) and a normal random variable with expectation 0 and variance 0.01. 

The credible intervals are computed via the monotone projection of the posterior estimates of f_0, starting with prior values 0 for the expectations of the normally distributed variables at J intervals and an estimate of the variance, explained in the paper of Moumita and Subhashis. The integer J is taken to be the floor of n^{1/3}log n, where n is the sample size. Also the parameter lambda_sq (sq for squared) is needed, which is taken to be 100. The 95% credible intervals are determined from the percentiles of 1000 experiments for each original sample, where in each case the posterior estimates of f_0 at the J intervals are computed. The overcoverage can be read from Table 2 in their paper. It means that the proportion of times that f_0(x) is not in the credible interval is expected to be 0.03676 (instead of 0.05.)

The directories "regression_percentile_bootstrap" and "correlation_percentile_bootstrap" correspond to, respectively, the percentile bootstrap method for the "regression model" and the "correlation model" in Section 3.1  and 3.2 of the manuscript "Credible intervals and bootstrap confidence intervals in monotone regression" by Piet Groeneboom and Geurt Jongbloed (see p. 2 of the manuscript for the explanation of these terms).

In the directory "smoothed_bootstrap" again the same 1000 samples are generated, but in this case for each original sample 1000 bootstrap samples are generated by generating Y_i*, where Y_i* is the sum of the SLSE f_{nh}(X_i) and a variable, generated by sampling with replacement from the centered residuals Y_k-\hat f_{nh}(X_k), k=1,...,n. The confidence intervals are determined from the 2.5th and 97.5th percentiles of the estimates in the 1000 bootstrap experiments. This procedure does not use the percentile method. The method corresponds to Section 4 of the manuscript "Credible intervals and bootstrap confidence intervals in monotone regression".

The R scripts can be used to reproduce the pictures in the manuscript "Credible intervals and bootstrap confidence intervals in monotone regression" (BayesFreqCI.pdf). The scripts Plot_test.R produces histograms like Figures 2 and Figure 9 in the manuscript "Credible intervals and bootstrap confidence intervals in monotone regression", where the point of evaluation of f0 is chosen x0=0.5.
